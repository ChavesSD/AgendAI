<!-- View de Gest√£o de Planos para o Dashboard Administrativo -->
<link rel="stylesheet" href="/public/css/plan-cards-fix.css">
<div class="d-flex" id="wrapper">
    <!-- Sidebar -->
    <div class="border-end bg-white" id="sidebar-wrapper">
        <div class="sidebar-heading bg-primary text-white py-4 d-flex justify-content-center">
            <div class="logo-container">
                <img src="/public/src/img/LogoAgendAIForFooter.png" alt="AgendAI Logo" class="logo-medium">
            </div>
        </div>
        <div class="list-group list-group-flush">
            <a href="#/admin/dashboard" class="list-group-item list-group-item-action">
                <i class="fas fa-tachometer-alt me-2"></i> Dashboard
            </a>
            <a href="#/admin/plans" class="list-group-item list-group-item-action active">
                <i class="fas fa-tags me-2"></i> Planos
            </a>
            <a href="#/admin/companies" class="list-group-item list-group-item-action">
                <i class="fas fa-building me-2"></i> Empresas
            </a>
            <a href="#/admin/users" class="list-group-item list-group-item-action" data-link>
                <i class="fas fa-users me-2"></i> Usu√°rios
            </a>
            <a href="#/admin/professionals" class="list-group-item list-group-item-action" data-link>
                <i class="fas fa-user-md me-2"></i> Profissionais
            </a>
            <a href="#/admin/services" class="list-group-item list-group-item-action" data-link>
                <i class="fas fa-list-alt me-2"></i> Servi√ßos
            </a>
            <a href="#/admin/clients" class="list-group-item list-group-item-action" data-link>
                <i class="fas fa-user-friends me-2"></i> Clientes
            </a>
            <a href="#/admin/appointments" class="list-group-item list-group-item-action" data-link>
                <i class="fas fa-calendar-alt me-2"></i> Agendamentos
            </a>
            <a href="#/admin/reports" class="list-group-item list-group-item-action" data-link>
                <i class="fas fa-chart-bar me-2"></i> Relat√≥rios
            </a>
            <a href="#/admin/settings" class="list-group-item list-group-item-action" data-link>
                <i class="fas fa-cog me-2"></i> Configura√ß√µes
            </a>
        </div>
    </div>
    
    <!-- Page Content -->
    <div id="page-content-wrapper">
        <nav class="navbar navbar-expand-lg navbar-light bg-light border-bottom">
            <div class="container-fluid">
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse" id="navbarSupportedContent">
                    <ul class="navbar-nav ms-auto mt-2 mt-lg-0">
                        <li class="nav-item">
                            <button class="btn btn-outline-secondary btn-sm mt-1" id="logout-button">
                                <i class="fas fa-sign-out-alt me-1"></i> Sair
                            </button>
                        </li>
                    </ul>
                </div>
            </div>
        </nav>
        
        <!-- Plans Content -->
        <div class="container-fluid p-4">
            <div class="row mb-4">
                <div class="col-md-12">
                    <h2 class="mb-3">Gest√£o de Planos</h2>
                    <p class="text-muted">Visualize os planos dispon√≠veis para as empresas que utilizam o AgendAI.</p>
                </div>
            </div>
            
            <!-- Plans Cards -->
            <div class="row mb-4">
                <!-- Plano B√°sico -->
                <div class="col-lg-4 mb-4">
                    <div class="card shadow h-100">
                        <div class="card-header py-3 bg-primary text-white">
                            <h6 class="m-0 font-weight-bold">Plano B√°sico</h6>
                </div>
                <div class="card-body">
                            <div class="text-center mb-4">
                                <h1 class="display-4 fw-bold text-primary">R$ 50,00</h1>
                                <p class="text-muted">por m√™s</p>
                    </div>
                            <ul class="list-group list-group-flush mb-4">
                                <li class="list-group-item"><i class="fas fa-check text-success me-2"></i> At√© 50 agendamentos/m√™s</li>
                                <li class="list-group-item"><i class="fas fa-check text-success me-2"></i> At√© 3 profissionais</li>
                                <li class="list-group-item"><i class="fas fa-check text-success me-2"></i> Notifica√ß√µes por e-mail</li>
                                <li class="list-group-item"><i class="fas fa-check text-success me-2"></i> Relat√≥rios b√°sicos</li>
                                <li class="list-group-item"><i class="fas fa-times text-danger me-2"></i> Notifica√ß√µes por WhatsApp</li>
                                <li class="list-group-item"><i class="fas fa-times text-danger me-2"></i> Personaliza√ß√£o avan√ßada</li>
                            </ul>
                </div>
                        <div class="card-footer text-center">
                            <span class="badge bg-success">Ativo</span>
        </div>
    </div>
</div>

                <!-- Plano Intermedi√°rio -->
                <div class="col-lg-4 mb-4">
                    <div class="card shadow h-100 border-primary">
                                <div class="card-header py-3 bg-primary text-white">
                            <h6 class="m-0 font-weight-bold">Plano Intermedi√°rio</h6>
                                </div>
                                <div class="card-body">
                                    <div class="text-center mb-4">
                                <h1 class="display-4 fw-bold text-primary">R$ 70,00</h1>
                                <p class="text-muted">por m√™s</p>
                                    </div>
                                    <ul class="list-group list-group-flush mb-4">
                                <li class="list-group-item"><i class="fas fa-check text-success me-2"></i> At√© 150 agendamentos/m√™s</li>
                                <li class="list-group-item"><i class="fas fa-check text-success me-2"></i> At√© 7 profissionais</li>
                                <li class="list-group-item"><i class="fas fa-check text-success me-2"></i> Notifica√ß√µes por e-mail</li>
                                <li class="list-group-item"><i class="fas fa-check text-success me-2"></i> Relat√≥rios avan√ßados</li>
                                <li class="list-group-item"><i class="fas fa-check text-success me-2"></i> Notifica√ß√µes por WhatsApp</li>
                                <li class="list-group-item"><i class="fas fa-times text-danger me-2"></i> Personaliza√ß√£o avan√ßada</li>
                                    </ul>
                                    </div>
                        <div class="card-footer text-center">
                            <span class="badge bg-success">Ativo</span>
                                </div>
                            </div>
                            </div>
                
                <!-- Plano Avan√ßado -->
                <div class="col-lg-4 mb-4">
                    <div class="card shadow h-100">
                    <div class="card-header py-3 bg-primary text-white">
                            <h6 class="m-0 font-weight-bold">Plano Avan√ßado</h6>
                    </div>
                    <div class="card-body">
                        <div class="text-center mb-4">
                                <h1 class="display-4 fw-bold text-primary">R$ 100,00</h1>
                                <p class="text-muted">por m√™s</p>
                        </div>
                        <ul class="list-group list-group-flush mb-4">
                                <li class="list-group-item"><i class="fas fa-check text-success me-2"></i> Agendamentos ilimitados</li>
                                <li class="list-group-item"><i class="fas fa-check text-success me-2"></i> Profissionais ilimitados</li>
                                <li class="list-group-item"><i class="fas fa-check text-success me-2"></i> Notifica√ß√µes por e-mail</li>
                                <li class="list-group-item"><i class="fas fa-check text-success me-2"></i> Relat√≥rios completos</li>
                                <li class="list-group-item"><i class="fas fa-check text-success me-2"></i> Notifica√ß√µes por WhatsApp</li>
                                <li class="list-group-item"><i class="fas fa-check text-success me-2"></i> Personaliza√ß√£o avan√ßada</li>
                        </ul>
                        </div>
                        <div class="card-footer text-center">
                            <span class="badge bg-success">Ativo</span>
                    </div>
                </div>
                        </div>
                        </div>
                                    </div>
                                    </div>
                                </div>

<!-- Script para gerenciar os planos -->
<script>
    document.addEventListener('DOMContentLoaded', function() {
        console.log('üöÄ P√°gina de planos carregada');
        
        // Remover qualquer tabela que possa ter sido inserida erroneamente nos cards de plano
        const removerTabelasErradas = function() {
            // Selecionar cards de planos
            const cardsPlanos = document.querySelectorAll('.col-lg-4.mb-4 .card');
            
            // Para cada card, verificar se h√° tabelas dentro dele
            cardsPlanos.forEach(card => {
                // Remover tabelas
                const tabelas = card.querySelectorAll('table');
                if (tabelas.length > 0) {
                    console.log('üîç Encontrada tabela incorreta dentro de card de plano. Removendo...');
                    tabelas.forEach(tabela => tabela.remove());
                }
                
                // Remover tamb√©m seus elementos pai que podem estar relacionados
                const tabelasDivs = card.querySelectorAll('.table-responsive');
                tabelasDivs.forEach(div => div.remove());
                
                // Remover outros elementos relacionados √† tabela
                const paginacoes = card.querySelectorAll('nav[aria-label="Page navigation"]');
                paginacoes.forEach(nav => nav.remove());
                
                // Remover elementos espec√≠ficos de empresas
                const elementosEmpresas = card.querySelectorAll('[id*="companies"], [id*="company"]');
                elementosEmpresas.forEach(elem => elem.remove());
                
                // Remover cabe√ßalhos e corpos de tabela que possam ter ficado
                card.querySelectorAll('th, tbody, thead, tr').forEach(elem => elem.remove());
                
                // Remover bot√µes relacionados √† tabela de empresas
                card.querySelectorAll('.edit-company, .delete-company, .view-company, button[data-id]').forEach(btn => {
                    if (btn.parentElement && btn.parentElement.className.includes('btn-group')) {
                        btn.parentElement.remove();
                    } else {
                        btn.remove();
                    }
                });
            });
        };
        
        // Executar a fun√ß√£o de remo√ß√£o imediatamente
        removerTabelasErradas();
        
        // Executar novamente ap√≥s pequenos delays para garantir que DOM est√° completo
        setTimeout(removerTabelasErradas, 300);
        setTimeout(removerTabelasErradas, 1000);
        setTimeout(removerTabelasErradas, 2000);
        
        // Executar periodicamente para prevenir reaparari√ß√£o
        setInterval(removerTabelasErradas, 3000);
        
        // Inicializar dados de planos no localStorage se n√£o existirem
        if (!localStorage.getItem('agendai_plans')) {
            const planosPadrao = [
                {
                    id: 1,
                    name: 'Plano B√°sico',
                    price: 50.00,
                    status: 'active',
                features: {
                        email: true,
                        whatsapp: false,
                        customization: false
                    },
                    maxAppointments: 50,
                    maxProfessionals: 3,
                    description: 'Plano b√°sico para pequenos neg√≥cios'
                },
                {
                    id: 2,
                    name: 'Plano Intermedi√°rio',
                    price: 70.00,
                    status: 'active',
                    features: {
                        email: true,
                        whatsapp: true,
                        customization: false
                    },
                    maxAppointments: 150,
                    maxProfessionals: 7,
                    description: 'Plano intermedi√°rio para neg√≥cios em crescimento'
                },
                {
                    id: 3,
                    name: 'Plano Avan√ßado',
                    price: 100.00,
                    status: 'active',
                    features: {
                        email: true,
                        whatsapp: true,
                        customization: true
                    },
                    maxAppointments: 0,
                    maxProfessionals: 0,
                    description: 'Plano avan√ßado para neg√≥cios estabelecidos'
                }
            ];
            
            localStorage.setItem('agendai_plans', JSON.stringify(planosPadrao));
            console.log('‚úÖ Planos padr√£o inicializados no localStorage');
                            } else {
            // For√ßar redefini√ß√£o para planos padr√£o para garantir que n√£o h√° altera√ß√µes
            const planosPadrao = [
                {
                    id: 1,
                    name: 'Plano B√°sico',
                    price: 50.00,
                    status: 'active',
                features: {
                        email: true,
                        whatsapp: false,
                        customization: false
                    },
                    maxAppointments: 50,
                    maxProfessionals: 3,
                    description: 'Plano b√°sico para pequenos neg√≥cios'
                },
                {
                    id: 2,
                    name: 'Plano Intermedi√°rio',
                    price: 70.00,
                    status: 'active',
                features: {
                        email: true,
                        whatsapp: true,
                        customization: false
                    },
                    maxAppointments: 150,
                    maxProfessionals: 7,
                    description: 'Plano intermedi√°rio para neg√≥cios em crescimento'
                },
                {
                    id: 3,
                    name: 'Plano Avan√ßado',
                    price: 100.00,
                    status: 'active',
                    features: {
                        email: true,
                        whatsapp: true,
                        customization: true
                    },
                    maxAppointments: 0,
                    maxProfessionals: 0,
                    description: 'Plano avan√ßado para neg√≥cios estabelecidos'
                }
            ];
            
            localStorage.setItem('agendai_plans', JSON.stringify(planosPadrao));
            console.log('‚úÖ Planos padr√£o restaurados no localStorage');
        }
        
        console.log('‚ÑπÔ∏è Os planos s√£o somente para visualiza√ß√£o e n√£o podem ser alterados.');
    });
</script>

<!-- Script para corrigir problemas nos cards de planos -->
<script src="/public/js/fix-plan-cards.js"></script> 

<!-- Script para persist√™ncia de planos no IndexedDB -->
<script src="/public/js/plans-indexeddb.js"></script>

</body>
</html> 